

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Computing the number of roots within a contour &#8212; cxroots 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Contours" href="contour.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="contour.html" title="Contours"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">cxroots 0.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="contour.html"
                        title="previous chapter">Contours</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/countroots.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="Computing-the-number-of-roots-within-a-contour">
<h1>Computing the number of roots within a contour<a class="headerlink" href="#Computing-the-number-of-roots-within-a-contour" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="cxroots.count_enclosed_roots">
<code class="descclassname">cxroots.</code><code class="descname">count_enclosed_roots</code><span class="sig-paren">(</span><em>C</em>, <em>f</em>, <em>df=None</em>, <em>integerTol=0.2</em>, <em>integrandUpperBound=10000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cxroots/CountRoots.html#count_enclosed_roots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cxroots.count_enclosed_roots" title="Permalink to this definition">¶</a></dt>
<dd><p>For a function of one complex variable, f(z), which is analytic in and within the contour C,
return the number of zeros (counting multiplicities) within the contour calculated, using
Cauchy&#8217;s argument principle, as</p>
<div class="math">
\[\frac{1}{2i\pi} \oint_C \frac{f'(z)}{f(z)} dz.\]</div>
<p>If df(z), the derivative of f(z), is provided then the above integral is computed directly.
Otherwise the derivative is approximated using a Taylor expansion about the central point
within the contour C.  The Taylor coefficients are calculated in such a way as to reuse
the function evaluations of f(z) on the contour C, as in method C of [DL].</p>
<p>The number of points on each segment of the contour C at which f(z) and df(z) are sampled
starts at 2+1 and at the k-th iteration the number of points is 2**k+1.  At each iteration
the above integral is calculated using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.romb.html">SciPy&#8217;s implementation of the Romberg method</a>.
The routine exits if the difference between successive iterations is &lt; integerTol.</p>
<p>The number of roots is then the closest integer to the final value of the integral
and the result is only accepted if the final value of the integral is within integerTol
of the closest integer.</p>
<p>If the contour is too close to a root then the integral will take a very long time to
converge and it is generally more efficient to instead choose a different contour.
For this reason the integration will be abandoned and a RuntimError raised if at any
point abs(df(z)/f(z)) &gt; integrandUpperBound since, according to [DL], the value of
abs(df(z)/f(z)) is of the order of 1/(distance to nearest root).  If df is being
approximated then the routine will wait for the maximum value of abs(df(z)/f(z)) on
the contour to settle down a little before considering if the routine should exit,
since an inaccurate df(z) can cause abs(df(z)/f(z)) to be erroneously large.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>C</strong> (<em>Contour</em>) &#8211; The enclosed_roots function returns the number of roots of f(z) within C</li>
<li><strong>f</strong> (<em>function</em>) &#8211; Function of a single variable f(x)</li>
<li><strong>df</strong> (<em>function</em><em>, </em><em>optional</em>) &#8211; Function of a single variable, df(x), providing the derivative of the function f(x)
at the point x.</li>
<li><strong>integerTol</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; The evaluation of the Cauchy integral will be accepted if the difference between successive
iterations is &lt; integerTol and the value of the integral is within integerTol of the
closest integer.  Since the Cauchy integral must be an integer it is only necessary to
distinguish which integer the integral is converging towards.  For this
reason the integerTol can be set fairly large.</li>
<li><strong>integrandUpperBound</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; The maximum allowed value of abs(df(z)/f(z)).  If abs(df(z)/f(z)) exceeds this
value then a RuntimeError is raised.  If integrandUpperBound is too large then
integrals may take a very long time to converge and it is generally be more
efficient to allow the rootfinding procedure to instead choose another contour
then spend time evaluating the integral along a contour very close to a root.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The number of zeros of f (counting multiplicities) which lie within the contour</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<dl class="docutils">
<dt>[DL] &#8220;A Numerical Method for Locating the Zeros of an Analytic function&#8221;,</dt>
<dd>L.M.Delves, J.N.Lyness, Mathematics of Computation (1967), Vol.21, Issue 100</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="contour.html" title="Contours"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">cxroots 0.2.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Robert Parini.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>